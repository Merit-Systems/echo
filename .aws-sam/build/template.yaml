AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Parameters:
  OpenAIAPIKeyValue:
    Type: String
    Description: OpenAI API Key for the Lambda environment variable.
Resources:
  LambdaFunction:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: LambdaFunction
      Handler: server.funcName
      Runtime: nodejs18.x
      Timeout: 30
      MemorySize: 256
      Policies:
      - AWSLambdaBasicExecutionRole
      Environment:
        Variables:
          OPENAI_API_KEY:
            Ref: OpenAIAPIKeyValue
      FunctionUrlConfig:
        AuthType: NONE
        InvokeMode: RESPONSE_STREAM
        Cors:
          AllowOrigins:
          - '*'
    Metadata:
      SamResourceId: LambdaFunction
